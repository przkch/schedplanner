---
export const prerender = false;

import { shift } from "@lib/database/schema";
import { fmtShift } from "@lib/utils";

import * as m from "@paraglide/messages";

const { id, year, month, day, employee_id, shifts } = Astro.props;
---

<dialog id={id} class="modal">
  <div class="modal-box">
    <form method="POST" action="/api/schedule">
      <div class="flex flex-col gap-4">
        <select name="shift_id" class="select select-bordered" required>
          <option value="none">None</option>
          {
            shifts.map((s: typeof shift.$inferSelect) => {
              return (
                <option value={s.id}>
                  {s.label ? (
                    s.label
                  ) : (
                    <>
                      {fmtShift(s.start)} - {fmtShift(s.end)}
                    </>
                  )}
                </option>
              );
            })
          }
        </select>
        <input name="employee_id" value={employee_id} hidden />
        <input name="year" value={year} hidden />
        <input name="month" value={month} hidden />
        <input name="day" value={day} hidden />

        <button class="btn">{m.add()}</button>
      </div>
    </form>
  </div>
  <form method="dialog" class="modal-backdrop">
    <button>close</button>
  </form>
</dialog>
